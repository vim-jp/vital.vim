
Describe Vim.Compat
  Before all
    let Compat = vital#of('vital').import('Vim.Compat')
  End

  Describe .has_version()
    It returns false when passed invalid argument
      Assert Falsy(Compat.has_version('hogera'))
      Assert Falsy(Compat.has_version(''))
    End
  End

  Describe .shiftwidth()
    It gives you &shiftwidth
      Assert Equals(Compat.shiftwidth(), &shiftwidth)
    End
    " TODO add other specs, refering Bram's Patch 7.3.694
  End

  Describe .writefile({list}, {fname}[, {flags}])
    It should write {list} into {fname}
      let list = ['hello', 'world']
      let fname = tempname()
      call Compat.writefile(list, fname)
      Assert Equals(readfile(fname), list)
      call delete(fname)
    End

    It should write {list} into {fname} in append mode with "a" flag
      let list = ['hello', 'world']
      let fname = tempname()
      call Compat.writefile(list, fname, "a")
      call Compat.writefile(list, fname, "a")
      Assert Equals(readfile(fname), ['hello', 'world', 'hello', 'world'])
      call delete(fname)
    End
  End
End
