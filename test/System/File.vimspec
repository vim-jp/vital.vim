let s:V = vital#of('vital')
let s:P = s:V.import('System.Filepath')

Describe System.File
  Before
    let File = s:V.import('System.File')
  End

  Context .writefile({list}, {fname}[, {flags}])
    It should write {list} into {fname}
      let list = ['hello', 'world']
      let fname = tempname()
      call File.writefile(list, fname)
      Assert Equals(readfile(fname), list)
      call delete(fname)
    End

    It should write {list} into {fname} in append mode with "a" flag
      let list = ['hello', 'world']
      let fname = tempname()
      call File.writefile(list, fname, "a")
      call File.writefile(list, fname, "a")
      Assert Equals(readfile(fname), ['hello', 'world', 'hello', 'world'])
      call delete(fname)
    End

    It should raise exception if "b" flag is specified
      if v:version > 704 || (v:version == 704 && has('patch503'))
        Skip Vim 7.4.503 starts to support flags in writefile so skip the test
      else
        let list = ['hello', 'world']
        let fname = tempname()
        Throw File.writefile(list, fname, "b") /^vital: System.File.writefile()/
      endif
    End
  End
End
